ropperstomper
=============

Build with llc <http://www.cs.virginia.edu/~lcc-win32/>

Limitations:

* Only supports x86 PE images.
* Doesn't consider linking relocations in gadgets.


```
C:\>ropperstomper.exe c:\Windows\SysWOW64\ntdll.dll
position: 0file: c:\Windows\SysWOW64\ntdll.dllfile size: 1292080Machine: i386Entry Point: 00000000Base of code: 0001000000013599:    20 RETN 10001000a:  2971 RETN00010004:  1201 INT 30001046d:     4 INT 30004363f:    13 JMP -200010005:   655 RETN 40001016e:   645 RETN 800039ca1:    12 RETN 300010024:   351 RETN 100001f93c:   232 RETN 140001011e:   557 RETN 0C0001fb35:    49 RETN 1C0001fff9:    38 RETN 200001fa35:   133 RETN 180001f904:    19 RETN 280001fc5d:    20 RETN 2C0001f8e8:    25 RETN 2400020f7d:     3 RETN 300003498e:     9 RETN 200020b45:    50 RETN 0000101b0:   215 POP EBP | RETN000135e4:     6 XCHG EAX,ESP | RETN000c3233:     2 XOR AL,AL | RETN00039a65:    16 XOR EAX,EAX | RETN00084b5b:     1 XCHG EAX,ECX | RETN0002df99:    17 POP EDI | RETN000682b6:     1 XOR EDI,EDI | RETN00037ce6:    21 POP ESI | RETN00083663:     3 POP ECX | RETN00030995:    30 POP EBX | RETN
...

00044060:     1 MOV DWORD PTR DS:[ESI],EDI | POP EDI | XOR EAX,EAX | POP ESI | POP EBX | POP EBP | RETN 100004495f:     1 MOV DWORD PTR DS:[ESI],EDI | POP EDI | POP ESI | MOV EAX,EBX | POP EBX | POP EBP | RETN 0C000c2a27:     1 MOV ECX,DWORD PTR DS:[ESI] | MOV DWORD PTR DS:[EAX],ECX | POP EDI | POP ESI | POP EBX | POP EBP | RETN 800079108:     1 POP EBP | POP EDI | POP ESI | POP EBX | MOV ESP,EBP | POP EBP | RETN0006cda1:     3 ADD ESP,0C | POP EDI | POP ESI | POP EBX | MOV ESP,EBP | POP EBP | RETN 0C00069d8e:     1 ADD ESP,0C | MOV EAX,ESI | POP EDI | POP ESI | POP EBX | POP EBP | RETN 8000c9cae:     1 ADD ESP,0C | MOV EAX,ESI | POP EDI | POP ESI | POP EBX | POP EBP | RETN 14000348b1:     1 POP EDI | POP ESI | POP EBX | XOR EAX,EAX | MOV ESP,EBP | POP EBP | RETN 0C000a8087:     1 MOV EAX,ESI | POP ESI | MOV ESP,EBP | POP EBP | MOV ESP,EBX | POP EBX | RETN 0C000a8086:     1 POP EDI | MOV EAX,ESI | POP ESI | MOV ESP,EBP | POP EBP | MOV ESP,EBX | POP EBX | RETN 0C000c2a25:     1 MOV DWORD PTR DS:[EDX],EAX | MOV ECX,DWORD PTR DS:[ESI] | MOV DWORD PTR DS:[EAX],ECX | POP EDI | POP ESI | POP EBX | POP EBP | RETN 80007b6ae:     1 MOV DWORD PTR DS:[EDI],EAX | XOR EAX,EAX | POP EDI | POP ESI | POP EBX | MOV ESP,EBP | POP EBP | RETN 14000c7f65:     1 MOV DWORD PTR DS:[EDI],EDX | MOV DWORD PTR DS:[EAX],ESI | MOV EAX,ESI | POP ESI | POP EBX | POP EDI | POP EBP | RETN 18000ac723:     1 MOV EAX,DWORD PTR DS:[ESI] | MOV DWORD PTR DS:[EDI],EAX | MOV DWORD PTR DS:[ESI],EDI | POP EDI | POP ESI | POP EBX | POP EBP | RETN 8000a81c0:     1 MOV EAX,EDI | POP EDI | POP ESI | MOV ESP,EBP | POP EBP | MOV ESP,EBX | POP EBX | RETN 100005879b:     1 MOV DWORD PTR DS:[ECX],EAX | XOR EAX,EAX | INC EAX | POP EDI | POP ESI | POP EBX | POP EBP | RETN 20Done!
```